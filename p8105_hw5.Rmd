---
title: "p8105_hw5"
author: "Tom Carpino, tc2899"
date: "November 8, 2018"
output: html_document
---

This homework flexes our skills on iteration and graphing. 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

### Problem 1: Case Control Study 

* The format of this problem involves the following: 
    + Importing the dataset
    + Tidying the dataset and creating a usable dataframe 
    + Creating a spaghetti plot 

Loading Packages: 
```{r echo = FALSE}
library(tidyverse)
library(plotly)
library(rvest)
library(magrittr)
```

Listing Files 
```{r}
listed_files = tibble(filepath = list.files("./data/", pattern = "*.csv", full.names = TRUE),
                         filename = basename(filepath))
```

Writing a function to read the data: 

```{r}
read_fx = function(data){
  read_csv(file = data)
}
```

Creating the dataframe: 

```{r, message = FALSE}
df_patient = listed_files %>% mutate(data =  purrr::map(listed_files$filepath, read_fx)) %>% 
  unnest() %>% 
  select(-filepath) %>% 
  gather(key = week, value = value, week_1:week_8) %>% 
  mutate(id = str_replace(filename, ".csv",""),
         week = as.numeric(str_replace(week, "week_", ""))) %>% 
  separate(id, into = c("group", "id"), sep = "_") %>% 
  mutate(id = as.factor(id))


```

### Problem 2: Crime in Large Cities 

* The format of this problem involves the following: 
    + Using the existing repo
    + Describing data 
    + Using functions to estimate crime rates
    + Creating plots with CIs


```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
